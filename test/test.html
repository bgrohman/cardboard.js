<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>cardboard.js - tests</title>
<link href="qunit.css" rel="stylesheet" type="text/css" media="screen"/>
<script src="qunit.js"></script>
<script src="../src/cardboard.js"></script>
<script>

test('the basics', function() {
    ok(cardboard);
    ok(cardboard.require);
    ok(cardboard.define);
    ok(cardboard.debug);
    cardboard.debug();
    ok(require);
    ok(define);
    ok(exports);
});

test('a basic module with no dependencies', function() {
    define('foo', {
        f: function() { console.log('foo'); }
    });

    ok(require('foo'));
    ok(require('foo').f);
    require('foo').f();
});

test('a module from function return with dependency', function() {
    define('bar', ['foo'], function(foo) {
        return {
            f: function() { foo.f(); console.log('bar'); }
        };
    });

    ok(require('bar'));
    ok(require('bar').f);
    require('bar').f();
});

test('a module from exports with dependencies', function() {
    define('baz', ['foo', 'bar'], function(foo, bar) {
        exports.f = function() {
            foo.f();
            bar.f();
            console.log('baz');
        };
    });

    ok(require('baz'));
    ok(require('baz').f);
    require('baz').f();
});

test('a module using require', function() {
    define('foo.bar.baz', function() {
        var foo = require('foo'),
            bar = require('bar'),
            baz = require('baz');

        exports.f = function() {
            foo.f();
            bar.f();
            baz.f();
            console.log('foo.bar.baz');
        };
    });

    ok(require('foo.bar.baz'));
    ok(require('foo.bar.baz').f);
    require('foo.bar.baz').f();
});

test('a missing dependency', function() {
    raises(function() {
        define('fail', ['oops'], function(missing) {});
    });
});

test('require with a missing module', function() {
    raises(function() {
        require('oh noes');
    });

    raises(function() {
        define('fail', function() { require('oh noes'); });
    });
});

test('define with wrong arguments', function() {
    raises(function() {
        define('blah');
    });

    raises(function() {
        define('blah', 'blah', 'blah', 'blah');
    });

    raises(function() {
        define('blah', 1, 1);
    });
});

</script>
</head>
<body>
    <h1 id="qunit-header">cardboard.js tests</h1>
    <h2 id="qunit-banner"></h2>
    <div id="qunit-testrunner-toolbar"></div>
    <h2 id="qunit-userAgent"></h2>
    <ol id="qunit-tests"></ol>
</body>
</html>
